#include "elasticBendingForce.h"

elasticBendingForce::elasticBendingForce(shared_ptr<elasticRod> m_rod, shared_ptr<timeStepper> m_stepper)
{
	rod = m_rod;
	stepper = m_stepper;

    Jbb = MatrixXd::Zero(6,6);
    flocal = VectorXd::Zero(6);
}

elasticBendingForce::~elasticBendingForce()
{
	;
}

void elasticBendingForce::computeFb()
{
    f = VectorXd::Zero(rod->ndof);

	for(int k=0; k < rod->nBends; k++)
	{
		ind0 = rod->bendingNodes[k][0];
		ind1 = rod->bendingNodes[k][1];
		ind2 = rod->bendingNodes[k][2];
		Vector2d p0 = rod->getVertex(ind0);
		Vector2d p  = rod->getVertex(ind1);
		Vector2d p1 = rod->getVertex(ind2);
		xkm1 = p0[0];
		ykm1 = p0[1];
		xk = p[0];
		yk = p[1];
		xkp1 = p1[0];
		ykp1 = p1[1];
		l_k = rod->l_k_bending[k];
		e0e1 = rod->e0e1[k];
		curvature0 = rod->kappaBar(k);

		// DEBUGGING: is the current curvature significantly different than kappaBar? Indexing issues?
		// Function call is computeCurvature(e0e1[i], Xkm1[0], Xkm1[1], Xk[0], Xk[1], Xkp1[0], Xkp1[1])
		double curvature_t = rod->computeCurvature(e0e1, xkm1, ykm1, xk, yk, xkp1, ykp1);
		// std::cout << "Curvature difference " << k << ": " << curvature_t - curvature0 << std::endl;
		// MORE DEBUGGING
		// if( curvature_t - curvature0 > 0.5 ){
		// 	std::cout << "At index " << k << "," << std::endl << "x_km1 = " << std::endl << p0 << std::endl;
		// 	std::cout << "x_k = " << std::endl << p << std::endl;
		// 	std::cout << "x_kp1 = " << std::endl << p1 << std::endl;
		// 	std::cout << "k0 = " << curvature0 << ", k_t = " << curvature_t << std::endl;
		// }
		
		// BUG: With curvature=2, i.e. 90 degrees, it seems the copy-pasted solution in localForce gives nans. Too much atan(tan(something)).
		// TO-DO: either edit the formula OR check for nans afterward and convert to zeros.
		localForce(); // populate flocal: first derivative of (curvature - curvature0)^2
		// Hack: replace NaNs with zero. THIS ASSUMES WE ARE NOT ACTUATING ANY 90 DEGREE KINKS
		flocal = (flocal.array().isFinite()).select(flocal,0);
		flocal = (- 0.5 * rod->EI(k) / l_k) * flocal; // scale with stiffness
		// std::cout << "Bending forces "<< k << ":" << std::endl << flocal << std::endl;
		
		f( 2*ind0   ) += flocal[0];
		f( 2*ind0+1 ) += flocal[1];
		f( 2*ind1   ) += flocal[2];
		f( 2*ind1+1 ) += flocal[3];
		f( 2*ind2   ) += flocal[4];
		f( 2*ind2+1 ) += flocal[5];		
	}

    stepper->subtractForce( f); // subtracting elastic force
}

void elasticBendingForce::computeJb()
{
	for(int k=0; k < rod->nBends; k++)
	{
		ind0 = rod->bendingNodes[k][0];
		ind1 = rod->bendingNodes[k][1];
		ind2 = rod->bendingNodes[k][2];
		Vector2d p0 = rod->getVertex(ind0);
		Vector2d p  = rod->getVertex(ind1);
		Vector2d p1 = rod->getVertex(ind2);
		xkm1 = p0[0];
		ykm1 = p0[1];
		xk = p[0];
		yk = p[1];
		xkp1 = p1[0];
		ykp1 = p1[1];
		l_k = rod->l_k_bending[k];
		e0e1 = rod->e0e1[k];
		curvature0 = rod->kappaBar(k);

		localJacobian(); // populate Jbb: second derivative of (curvature - curvature0)^2
		// BUG: Jbb has NaNs when curvature = 2.
		// Hack: replace NaNs with zero. THIS ASSUMES WE ARE NOT ACTUATING ANY 90 DEGREE KINKS
		Jbb = (Jbb.array().isFinite()).select(Jbb,0);
		Jbb = (0.5 * rod->EI(k) / l_k) * Jbb; // scale with stiffness
		
		for (int i=0; i < 3; i++)
			for (int j=0; j < 3; j++)
			{
				ind0 = rod->bendingNodes[k][i];
				ind1 = rod->bendingNodes[k][j];

				stepper->addElaticJacobian( 2*ind0,   2*ind1,   Jbb(2*i,2*j) );				
				stepper->addElaticJacobian( 2*ind0,   2*ind1+1, Jbb(2*i,2*j+1) );				
				stepper->addElaticJacobian( 2*ind0+1, 2*ind1,   Jbb(2*i+1,2*j) );				
				stepper->addElaticJacobian( 2*ind0+1, 2*ind1+1, Jbb(2*i+1,2*j+1) );				
			}
	}
}


void elasticBendingForce::reserveJacobianSpace()
{
	for(int k=0; k < rod->nBends; k++)
	{
		for (int i=0; i < 3; i++)
			for (int j=0; j < 3; j++)
			{
				ind0 = rod->bendingNodes[k][i];
				ind1 = rod->bendingNodes[k][j];

				stepper->addJacobianMat( 2*ind0,   2*ind1,   1 );				
				stepper->addJacobianMat( 2*ind0,   2*ind1+1, 1 );				
				stepper->addJacobianMat( 2*ind0+1, 2*ind1,   1 );				
				stepper->addJacobianMat( 2*ind0+1, 2*ind1+1, 1 );				
			}
	}
}

void elasticBendingForce::returnFb(VectorXd &m_f)
{
	m_f = m_f - f;
}

void elasticBendingForce::localForce()
{	
	flocal(0) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	flocal(1) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	flocal(2) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	flocal(3) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	flocal(4) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	flocal(5) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
}

void elasticBendingForce::localJacobian()
{
	Jbb(0,0) = 0.2e1 * pow((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(-xkp1 + xk, 0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - yk) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(0,1) = 0.2e1 * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) - pow(-xkp1 + xk, 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (-ykp1 + yk)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(0,2) = 0.2e1 * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) - (-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (xkp1 - 0.2e1 * xk + xkm1) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(0,3) = 0.2e1 * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) - (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (ykp1 - 0.2e1 * yk + ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkm1 + xkp1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(0,4) = 0.2e1 * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) - (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (xk - xkm1) + (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(0,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (yk - ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));

	Jbb(1,0) = Jbb(0,1);
	Jbb(1,1) = 0.2e1 * pow((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (-xkp1 + xk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(-ykp1 + yk, 0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(1,2) = 0.2e1 * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-xkp1 + xk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) - (-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk) * (xkp1 - 0.2e1 * xk + xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(1,3) = 0.2e1 * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(-xkp1 + xk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) - (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk) * (ykp1 - 0.2e1 * yk + ykm1) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkm1 + xkp1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(1,4) = 0.2e1 * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-xkp1 + xk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) - (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk) * (xk - xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(1,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk) * (yk - ykm1) + (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));

	Jbb(2,0) = Jbb(0,2);
	Jbb(2,1) = Jbb(1,2);
	Jbb(2,2) = 0.2e1 * pow((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(xkp1 - 0.2e1 * xk + xkm1, 0.2e1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(2,3) = 0.2e1 * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) - (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1) * (ykp1 - 0.2e1 * yk + ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkm1 + xkp1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(2,4) = 0.2e1 * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) - (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1) * (xk - xkm1) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(2,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1) * (yk - ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));

	Jbb(3,0) = Jbb(0,3);
	Jbb(3,1) = Jbb(1,3);
	Jbb(3,2) = Jbb(2,3);
	Jbb(3,3) = 0.2e1 * pow((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(ykp1 - 0.2e1 * yk + ykm1, 0.2e1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkm1 + xkp1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(3,4) = 0.2e1 * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) - (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1) * (xk - xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(3,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1) * (yk - ykm1) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));

	Jbb(4,0) = Jbb(0,4);
	Jbb(4,1) = Jbb(1,4);
	Jbb(4,2) = Jbb(2,4);
	Jbb(4,3) = Jbb(3,4);
	Jbb(4,4) = 0.2e1 * pow((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(xk - xkm1, 0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	Jbb(4,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-pow(yk - ykm1, 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1) * (yk - ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
	
	Jbb(5,0) = Jbb(0,5);
	Jbb(5,1) = Jbb(1,5);
	Jbb(5,2) = Jbb(2,5);
	Jbb(5,3) = Jbb(3,5);
	Jbb(5,4) = Jbb(4,5);
	Jbb(5,5) = 0.2e1 * pow((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(yk - ykm1, 0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
}
